



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Learning How to Program in SAS">
      
      
      
        <meta name="author" content="Lucía Rodrigo Insausti">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1, mkdocs-material-4.6.3">
    
    
      
        <title>Clustering - SAS Manual</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.adb8469c.css">
      
      
    
    
      <script src="../../assets/javascripts/modernizr.86422ebf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#introduction-to-cluster-analysis" tabindex="0" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="SAS Manual" aria-label="SAS Manual" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              SAS Manual
            </span>
            <span class="md-header-nav__topic">
              
                Clustering
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" aria-label="search" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../.." title="SAS Manual" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    SAS Manual
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Gettin' Started!" class="md-nav__link">
      Gettin' Started!
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      The Essentials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        The Essentials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../essentials/accessing/" title="Accessing Data" class="md-nav__link">
      Accessing Data
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../essentials/reporting/" title="Producing Detailed Reports" class="md-nav__link">
      Producing Detailed Reports
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../essentials/formatting/" title="Formatting Data Values" class="md-nav__link">
      Formatting Data Values
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../essentials/reading-sas/" title="Reading SAS Data Sets" class="md-nav__link">
      Reading SAS Data Sets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../essentials/reading-spreadsheets/" title="Reading Spreadsheet and Database Data" class="md-nav__link">
      Reading Spreadsheet and Database Data
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../essentials/reading-raw/" title="Reading Raw Data Files" class="md-nav__link">
      Reading Raw Data Files
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../essentials/manipulation/" title="Manipulating Data" class="md-nav__link">
      Manipulating Data
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../essentials/combination/" title="Combining SAS Data Sets" class="md-nav__link">
      Combining SAS Data Sets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../essentials/summary/" title="Creating Summary Reports" class="md-nav__link">
      Creating Summary Reports
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Basic Statistics
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Basic Statistics
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../statistics/introduction/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../statistics/anova/" title="Analysis of Variance (ANOVA)" class="md-nav__link">
      Analysis of Variance (ANOVA)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../statistics/regression/" title="Regression" class="md-nav__link">
      Regression
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../statistics/inference/" title="Model Post-Fitting for Inference" class="md-nav__link">
      Model Post-Fitting for Inference
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../statistics/categorical-data/" title="Categorical Data Analysis" class="md-nav__link">
      Categorical Data Analysis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../statistics/prediction/" title="Model Building and Scoring for Prediction" class="md-nav__link">
      Model Building and Scoring for Prediction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../statistics/miscellanea/" title="Miscellanea" class="md-nav__link">
      Miscellanea
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Using Macros
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Using Macros
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../macros/introducing-macrovar/" title="Introducing Macro Variables" class="md-nav__link">
      Introducing Macro Variables
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../macros/using-macrofunc/" title="Using Macro Functions" class="md-nav__link">
      Using Macro Functions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../macros/macrovar-at-execution-time/" title="Creating Macro Variables at Execution Time" class="md-nav__link">
      Creating Macro Variables at Execution Time
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../macros/macroprog/" title="Creating and Using Macro Programs" class="md-nav__link">
      Creating and Using Macro Programs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../macros/macroprog-processing/" title="Using Conditional and Iterative Processing in Macro Programs" class="md-nav__link">
      Using Conditional and Iterative Processing in Macro Programs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../macros/debugging-options/" title="Debugging Options" class="md-nav__link">
      Debugging Options
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../macros/more-macro/" title="More on Macro Programming" class="md-nav__link">
      More on Macro Programming
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      SQL
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        SQL
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../sql/getting-started/" title="Getting Started with the SQL Procedure" class="md-nav__link">
      Getting Started with the SQL Procedure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sql/efficiencies/" title="Measuring Efficiencies" class="md-nav__link">
      Measuring Efficiencies
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sql/displaying-results/" title="Displaying Query Results" class="md-nav__link">
      Displaying Query Results
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sql/joins/" title="Working with SQL Joins" class="md-nav__link">
      Working with SQL Joins
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sql/nested-queries/" title="Working with Nested Queries" class="md-nav__link">
      Working with Nested Queries
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sql/set-operators/" title="Working with Set Operators" class="md-nav__link">
      Working with Set Operators
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sql/tables-views/" title="Creating Tables and Views" class="md-nav__link">
      Creating Tables and Views
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sql/advanced/" title="Using Advanced PROC SQL Features" class="md-nav__link">
      Using Advanced PROC SQL Features
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sql/miscellanea/" title="Miscellanea" class="md-nav__link">
      Miscellanea
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6" checked>
    
    <label class="md-nav__link" for="nav-6">
      Other Analysis
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Other Analysis
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../model-selection/" title="Model Selection" class="md-nav__link">
      Model Selection
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../missing-data/" title="Dealing with Missing Data" class="md-nav__link">
      Dealing with Missing Data
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../interim-analysis/" title="Interim Analysis Design" class="md-nav__link">
      Interim Analysis Design
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../normality-tests/" title="Normality Tests" class="md-nav__link">
      Normality Tests
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../post-hoc-tests/" title="Post-hoc Tests" class="md-nav__link">
      Post-hoc Tests
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../effect-size/" title="Effect Size" class="md-nav__link">
      Effect Size
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../propensity-score/" title="Propensity Score" class="md-nav__link">
      Propensity Score
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../roc-curve/" title="ROC Curve" class="md-nav__link">
      ROC Curve
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../questionnaires/" title="Questionnaires analysis" class="md-nav__link">
      Questionnaires analysis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sequence-design/" title="Sequence Design" class="md-nav__link">
      Sequence Design
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../survival-analysis/" title="Survival Analysis" class="md-nav__link">
      Survival Analysis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../HR_vs_OR_vs_RR/" title="Odds Ratio, Hazard Ratio and Relative Risk" class="md-nav__link">
      Odds Ratio, Hazard Ratio and Relative Risk
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Clustering
      </label>
    
    <a href="./" title="Clustering" class="md-nav__link md-nav__link--active">
      Clustering
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction-to-cluster-analysis" class="md-nav__link">
    Introduction to Cluster Analysis
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gettin-ready-for-a-cluster-analysis" class="md-nav__link">
    Gettin' Ready for a Cluster Analysis
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#check-for-missing-data" class="md-nav__link">
    Check for Missing Data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dealing-with-categorical-variables" class="md-nav__link">
    Dealing with Categorical Variables
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#composite-variables" class="md-nav__link">
    Composite variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hot-encoding" class="md-nav__link">
    Hot encoding
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ordinal-categorical-variables" class="md-nav__link">
    Ordinal Categorical Variables
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods-for-data-reduction" class="md-nav__link">
    Methods for data reduction
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#factor-analysis" class="md-nav__link">
    Factor Analysis
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#standardize-your-data" class="md-nav__link">
    Standardize your Data
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sas-procedures-to-perform-cluster-analysis" class="md-nav__link">
    SAS Procedures to Perform Cluster Analysis
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#proc-cluster-hierarchical-cluster-analysis" class="md-nav__link">
    PROC CLUSTER: Hierarchical Cluster Analysis
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#proc-fastclus-disjoint-cluster-analysis" class="md-nav__link">
    PROC FASTCLUS: Disjoint Cluster Analysis
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mixed-clustering" class="md-nav__link">
    Mixed Clustering
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#proc-varclus-variable-clustering" class="md-nav__link">
    PROC VARCLUS: Variable Clustering
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#proc-tree" class="md-nav__link">
    PROC TREE
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#choosing-the-optimal-number-of-clusters-for-the-analysis" class="md-nav__link">
    Choosing the Optimal Number of Clusters for the Analysis
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#further-examination-of-the-cluster-analysis-solution" class="md-nav__link">
    Further Examination of the Cluster Analysis Solution
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#visualizing-the-results" class="md-nav__link">
    Visualizing the Results
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cluster-means-and-standard-deviations" class="md-nav__link">
    Cluster Means and Standard Deviations
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Specific Procedures
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Specific Procedures
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../procedures/regression-models/" title="General Notes on Regression Procedures" class="md-nav__link">
      General Notes on Regression Procedures
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../procedures/glimmix/" title="PROC GLIMMIX" class="md-nav__link">
      PROC GLIMMIX
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../procedures/mixed/" title="PROC MIXED" class="md-nav__link">
      PROC MIXED
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      SAS Outputs
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        SAS Outputs
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../sas-outputs/ods/" title="Output Delivery System" class="md-nav__link">
      Output Delivery System
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sas-outputs/graphs/" title="Graphs and Plots" class="md-nav__link">
      Graphs and Plots
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sas-outputs/print/" title="PROC PRINT" class="md-nav__link">
      PROC PRINT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sas-outputs/report/" title="PROC REPORT" class="md-nav__link">
      PROC REPORT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sas-outputs/tabulate/" title="PROC TABULATE" class="md-nav__link">
      PROC TABULATE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sas-outputs/template/" title="PROC TEMPLATE" class="md-nav__link">
      PROC TEMPLATE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sas-outputs/pdf/" title="Write to pdf file" class="md-nav__link">
      Write to pdf file
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sas-outputs/excel/" title="Export to Excel file" class="md-nav__link">
      Export to Excel file
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      SAS vs R
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        SAS vs R
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../sasvsr/introduction/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sasvsr/importing-reporting/" title="Importing and Reporting Data" class="md-nav__link">
      Importing and Reporting Data
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sasvsr/variables-functions/" title="Creating New Variables, Functions and Data Tables" class="md-nav__link">
      Creating New Variables, Functions and Data Tables
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sasvsr/random-plotting/" title="Random Number Generation and Plotting" class="md-nav__link">
      Random Number Generation and Plotting
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sasvsr/proc-ods-macros/" title="Descriptive Procedures, Output Delivery System and Macros" class="md-nav__link">
      Descriptive Procedures, Output Delivery System and Macros
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sasvsr/inferential/" title="Analyzing the Data via Inferential Procedures" class="md-nav__link">
      Analyzing the Data via Inferential Procedures
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sasvsr/iml/" title="Interactive Matrix Language (IML)" class="md-nav__link">
      Interactive Matrix Language (IML)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sasvsr/bridge/" title="A Bridge Between SAS and R" class="md-nav__link">
      A Bridge Between SAS and R
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../wizard/" title="Using Wizard Menus" class="md-nav__link">
      Using Wizard Menus
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../sasvi/" title="SAS Visual Analytics" class="md-nav__link">
      SAS Visual Analytics
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-12" type="checkbox" id="nav-12">
    
    <label class="md-nav__link" for="nav-12">
      CDISC
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-12">
        CDISC
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../CDISC/introduction/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-13" type="checkbox" id="nav-13">
    
    <label class="md-nav__link" for="nav-13">
      Miscellanea
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-13">
        Miscellanea
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../miscellanea/arrays/" title="Working with Arrays" class="md-nav__link">
      Working with Arrays
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../miscellanea/execution-time/" title="Execution time" class="md-nav__link">
      Execution time
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../miscellanea/time-intervals/" title="Time intervals" class="md-nav__link">
      Time intervals
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../miscellanea/patient-identification/" title="Patient identification" class="md-nav__link">
      Patient identification
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../miscellanea/random-list/" title="Generating a Random List" class="md-nav__link">
      Generating a Random List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../miscellanea/shell/" title="Shell Scripting in SAS" class="md-nav__link">
      Shell Scripting in SAS
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-14" type="checkbox" id="nav-14">
    
    <label class="md-nav__link" for="nav-14">
      Medical terms
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-14">
        Medical terms
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../medical/general/" title="General" class="md-nav__link">
      General
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../medical/labs/" title="Laboratory Test" class="md-nav__link">
      Laboratory Test
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../medical/exposure/" title="Treatment Exposure" class="md-nav__link">
      Treatment Exposure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../medical/orr-dcr/" title="ORR and DCR" class="md-nav__link">
      ORR and DCR
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../medical/recist/" title="RECIST v1.1" class="md-nav__link">
      RECIST v1.1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../medical/irecist/" title="iRECIST" class="md-nav__link">
      iRECIST
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-15" type="checkbox" id="nav-15">
    
    <label class="md-nav__link" for="nav-15">
      R with Shiny
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-15">
        R with Shiny
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../R-with-Shiny/introduction/" title="Introduction and Shiny Basics" class="md-nav__link">
      Introduction and Shiny Basics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../R-with-Shiny/input-output/" title="Inputs, Outputs, and Rendering Functions" class="md-nav__link">
      Inputs, Outputs, and Rendering Functions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../R-with-Shiny/reactive/" title="Reactive Programming" class="md-nav__link">
      Reactive Programming
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../R-with-Shiny/custom/" title="Customizing Appearance" class="md-nav__link">
      Customizing Appearance
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction-to-cluster-analysis" class="md-nav__link">
    Introduction to Cluster Analysis
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gettin-ready-for-a-cluster-analysis" class="md-nav__link">
    Gettin' Ready for a Cluster Analysis
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#check-for-missing-data" class="md-nav__link">
    Check for Missing Data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dealing-with-categorical-variables" class="md-nav__link">
    Dealing with Categorical Variables
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#composite-variables" class="md-nav__link">
    Composite variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hot-encoding" class="md-nav__link">
    Hot encoding
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ordinal-categorical-variables" class="md-nav__link">
    Ordinal Categorical Variables
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods-for-data-reduction" class="md-nav__link">
    Methods for data reduction
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#factor-analysis" class="md-nav__link">
    Factor Analysis
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#standardize-your-data" class="md-nav__link">
    Standardize your Data
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sas-procedures-to-perform-cluster-analysis" class="md-nav__link">
    SAS Procedures to Perform Cluster Analysis
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#proc-cluster-hierarchical-cluster-analysis" class="md-nav__link">
    PROC CLUSTER: Hierarchical Cluster Analysis
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#proc-fastclus-disjoint-cluster-analysis" class="md-nav__link">
    PROC FASTCLUS: Disjoint Cluster Analysis
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mixed-clustering" class="md-nav__link">
    Mixed Clustering
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#proc-varclus-variable-clustering" class="md-nav__link">
    PROC VARCLUS: Variable Clustering
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#proc-tree" class="md-nav__link">
    PROC TREE
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#choosing-the-optimal-number-of-clusters-for-the-analysis" class="md-nav__link">
    Choosing the Optimal Number of Clusters for the Analysis
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#further-examination-of-the-cluster-analysis-solution" class="md-nav__link">
    Further Examination of the Cluster Analysis Solution
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#visualizing-the-results" class="md-nav__link">
    Visualizing the Results
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cluster-means-and-standard-deviations" class="md-nav__link">
    Cluster Means and Standard Deviations
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Clustering</h1>
                
                <h2 id="introduction-to-cluster-analysis">Introduction to Cluster Analysis<a class="headerlink" href="#introduction-to-cluster-analysis" title="Permanent link">Link</a></h2>
<p>When subjects are sampled, randomized or allocated by clusters, several statistical problems arise. If observations within a cluster are correlated, one of the assumptions of estimation and hypothesis testing is violated. Because of this correlation, the analyses must be modified to take into account the cluster design effect. When cluster designs are used, there are two sources of variations in the observations. The first is the <strong>one between subjects within a cluster</strong>, and the second is the <strong>variability among clusters</strong>. These two sources of variation cause the variance to inflate and must be taken into account in the analysis.</p>
<h2 id="gettin-ready-for-a-cluster-analysis">Gettin' Ready for a Cluster Analysis<a class="headerlink" href="#gettin-ready-for-a-cluster-analysis" title="Permanent link">Link</a></h2>
<h3 id="check-for-missing-data">Check for Missing Data<a class="headerlink" href="#check-for-missing-data" title="Permanent link">Link</a></h3>
<p>Variables with missing data should be excluded from the calculation unless they can be imputed.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="nv">DATA</span> <span class="nv">SAS</span><span class="o">-</span><span class="nv">data</span><span class="o">-</span><span class="nv">set</span><span class="o">-</span><span class="nv">without</span><span class="o">-</span><span class="nv">missing</span><span class="c1">;</span>
    <span class="nv">SET</span> <span class="nv">SAS</span><span class="o">-</span><span class="nv">data</span><span class="o">-</span><span class="nv">set</span><span class="o">-</span><span class="nv">with</span><span class="o">-</span><span class="nv">missing</span><span class="c1">;</span>
    <span class="k">IF</span> <span class="nv">CMISS</span><span class="ss">(</span><span class="nv">OF</span> <span class="nv">_ALL_</span><span class="ss">)</span> <span class="k">THEN</span> <span class="nv">DELETE</span><span class="c1">;</span>
<span class="nv">RUN</span><span class="c1">;</span>
</code></pre></div>
</td></tr></table>

<h3 id="dealing-with-categorical-variables">Dealing with Categorical Variables<a class="headerlink" href="#dealing-with-categorical-variables" title="Permanent link">Link</a></h3>
<h4 id="composite-variables">Composite variables<a class="headerlink" href="#composite-variables" title="Permanent link">Link</a></h4>
<p>Other questionnaire data like binary (yes/no questions) or a spectrum of responses can be transformed into <strong>composite variables</strong> to capture multiple questions into a <strong>ranked ordinal scale</strong>. A <strong>composite variable</strong> is a variable created by combining two or more individual variables, called indicators, into a single variable. Each indicator alone doesn't provide sufficient information, but altogether they can represent the more complex concept.</p>
<p>A lot of work goes into creating composite variables. The indicators of the multidimensional concept must be specified. It's important that each indicator contribute unique information to the final score. The formula for combining the indicators into a single score, called aggregating data, must be established. The computation involved will depend on the type of data that is being aggregated. To aggregate the data, raw scores might be summed, averaged, transformed, and/or weighted.</p>
<h4 id="hot-encoding">Hot encoding<a class="headerlink" href="#hot-encoding" title="Permanent link">Link</a></h4>
<p>Check <a href="https://heuristically.wordpress.com/2013/02/11/dummy-coding-sas/">this website</a> for a macro to generate dummy variables.</p>
<h4 id="ordinal-categorical-variables">Ordinal Categorical Variables<a class="headerlink" href="#ordinal-categorical-variables" title="Permanent link">Link</a></h4>
<p>If your categorical variables have an ordinal meaning you can create an auxiliary numeric variable with indexes representing the ordinal scale and use this new variable, which can be standardized, for the analysis.</p>
<h3 id="methods-for-data-reduction">Methods for data reduction<a class="headerlink" href="#methods-for-data-reduction" title="Permanent link">Link</a></h3>
<p>You may need to reduce the number of variables to include in the analysis. There are several methods for this:</p>
<ul>
<li><a href="https://stats.idre.ucla.edu/sas/output/principal-components-analysis/">Principal Component Analysis with <code>PROC FACTOR</code></a></li>
<li><a href="http://www2.sas.com/proceedings/sugi26/p261-26.pdf">Variable Reduction for Modeling using <code>PROC VARCLUS</code></a></li>
</ul>
<h4 id="factor-analysis">Factor Analysis<a class="headerlink" href="#factor-analysis" title="Permanent link">Link</a></h4>
<p>Factor analysis is a method of data reduction.  It does this by seeking underlying unobservable variables (<strong>latent variables</strong>) that are reflected in the observed variables (<strong>manifest variables</strong>). </p>
<ul>
<li>There are many different <strong>methods</strong> that can be used to conduct a factor analysis (such as principal axis factor, maximum likelihood, generalized least squares, unweighted least squares). Each of them generates uncorrelated factors. </li>
<li>There are also many different <strong>types of rotations</strong> that can be done after the initial extraction of factors, including orthogonal rotations, such as varimax and equimax, which impose the restriction that the factors cannot be correlated, and oblique rotations, such as promax, which allow the factors to be correlated with one another. It is generally considered that using a rotation in factor analysis will produce more interpretable results. If the factor analysis is being performed specifically to gain an explanation of what factors or groups exist in the data or to confirm hypothesized assumptions about the data, rotation can be especially helpful. Factor patterns can be rotated through two different ways:<ul>
<li>Orthogonal rotations which retain uncorrelated factors</li>
<li>Oblique rotations which create correlated factors
While arguments exist supporting both types of rotation methods, factor analysis which uses an <strong>orthogonal rotation often creates a solution that is easier to grasp and interpret</strong> than a solution obtained from an oblique rotation. </li>
</ul>
</li>
<li>You also need to determine the <strong>number of factors</strong> that you want to extract. Normally, the objetive during the initial factor analysis is to determine the minimum number of factors that will adequately account for the covariation among the larger number of analysis variables. This objective can be achieved by using any of the initial factoring methods.</li>
</ul>
<p>Given the number of factor analytic techniques and options, it is not surprising that different analysts could reach very different results analyzing the same data set. However, all analysts are looking for simple structure. Simple structure is pattern of results such that <strong>each variable loads highly onto one and only one factor</strong>.</p>
<p>Factor analysis is a technique that requires a <strong>large sample size</strong> because it is based on the correlation matrix of the variables involved, and correlations usually need a large sample size before they stabilize. </p>
<div class="admonition tip">
<p class="admonition-title">Advisable sample size</p>
<ul>
<li>50 cases is very poor, 100 is poor, 200 is fair, 300 is good, 500 is very good, and 1000 or more is excellent </li>
<li>As a rule of thumb, a bare minimum of <strong>10 observations per variable</strong> is necessary to avoid computational difficulties</li>
</ul>
</div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">PROC</span> <span class="n">FACTOR</span> <span class="k">DATA</span><span class="o">=</span><span class="n">SAS</span><span class="o">-</span><span class="k">data</span><span class="o">-</span><span class="k">set</span> <span class="n">NFACTORS</span><span class="o">=</span><span class="mi">3</span> <span class="n">CORR</span> <span class="n">SCREE</span> <span class="n">EV</span> <span class="n">REORDER</span> <span class="n">ROTATE</span><span class="o">=</span><span class="n">VARIMAX</span> <span class="k">METHOD</span><span class="o">=</span><span class="n">PRINIT</span> <span class="n">PRIORS</span><span class="o">=</span><span class="n">SMC</span><span class="p">;</span>
    <span class="n">VAR</span> <span class="n">var1</span> <span class="n">var2</span> <span class="n">var3</span> <span class="p">...</span> <span class="n">varn</span><span class="p">;</span>
<span class="n">RUN</span><span class="p">;</span>
</code></pre></div>
</td></tr></table>

<ul>
<li><code>METHOD=</code> specifies what type of method is to be used to extract the initial factors. The <strong>Principal Components Analysis (PCA)</strong> method (<code>PRINCIPAL</code>) simply transforms the set of variables into another set of variables; that is, the data is summarized by means of a linear combination of the observed data. This transformation is performed when the objective is to account for as much variation as possible in the data. With PCA, the first component/factor is defined in such a way that the largest amount of variance in the data is explained by the first component. The second component/factor explains the second most about the variance in the data and is <strong>perpendicular (thus, uncorrelated)</strong> to the first component. The remaining components/factors are found in a similar manner.</li>
<li><code>MINEIGEN =</code> specifies the smallest eigenvalue for which a factor is retained.</li>
<li><code>NFACTOR =</code> specifies the number of factors to be extracted from the data. The default value, if this option is not specified, is the number of variables in the data. The optimum number can be selected by first running <code>PROC FACTOR</code> without the <code>NFACTOR</code> option and analyzing the eigenvalues and <code>SCREE</code> plot. </li>
<li><code>REORDER</code>: This option reorders the output, so the variables that explain the largest amount of the variance for each factor are printed in descending order down to those that explain the smallest amount of the variance for each factor.</li>
<li><code>CORR</code> generates the <strong>Correlations</strong> table containing the correlations between the original variables (the ones specified on the <code>VAR</code> statement). Before conducting a principal components analysis, you want to check the correlations between the variables.  If any of the correlations are too high (say above .9), you may need to remove one of the variables from the analysis, as the two variables seem to be measuring the same thing.  Another alternative would be to combine the variables in some way (perhaps by taking the average).  If the correlations are too low, say below .1, then one or more of the variables might load only onto one factor (in other words, make its own factor).</li>
<li><code>EV</code> displays the eigenvectors of the reduced correlation matrix, of which the diagonal elements are replaced with the communality estimates.</li>
<li><code>SCREE</code> or <code>PLOTS=SCREE</code> graph the eigenvalue against the factor number. The ploted values are contained in the <strong>Initial Factor Method: Iterated Principal Factor Analysis</strong> table:<ul>
<li><strong>Iteration</strong>: This column lists the number of the iteration. </li>
<li><strong>Change</strong>: When the change becomes smaller than the criterion, the iterating process stops.  The numbers in this column are the largest absolute difference between iterations. The difference given for the first iteration is the difference between the values at the first iteration and the squared multiple correlations (sometimes called iteration 0).</li>
<li><strong>Communalities</strong>: These are the communality estimates at each iteration.  For each iteration, the communality for each variable is listed.</li>
</ul>
</li>
<li><code>PRIORS=SMC</code> enables the squared multiple correlation to be used on the diagonal of the correlation matrix. If this option is not used, 1’s are on the diagonal, and you will do a PCA instead of a principal axis factor analysis. The <strong>Prior Communality Estimates:  SMC</strong> table gives the communality estimates prior to the rotation.  The communalities (also known as h2) are the estimates of the variance of the factors, as opposed to the variance of the variable which includes measurement error. This table contains different values:<ul>
<li><strong>Eigenvalue</strong>: This is the initial eigenvalue.  An eigenvalue is the variance of the factor.  Because this is an unrotated solution, the first factor will account for the most variance, the second will account for the second highest amount of variance, and so on.  Some of the eigenvalues are negative because the matrix is not of full rank.  This means that there are probably only four dimensions (corresponding to the four factors whose eigenvalues are greater than zero).  Although it is strange to have a negative variance, this happens because the factor analysis is only analyzing the common variance, which is less than the total variance.  If we were doing a principal components analysis, we would have had 1’s on the diagonal, which means that all of the variance is being analyzed (which is another way of saying that we are assuming that we have no measurement error), and we would not have negative eigenvalues.  In general, it is not uncommon to have negative eigenvalues.</li>
<li><strong>Difference</strong>: This column gives the difference between the eigenvalues and allows you to see how quickly the eigenvalues are decreasing.</li>
<li><strong>Proportion</strong>: This is the proportion of the total variance that each factor accounts for.</li>
<li><strong>Cumulative</strong>: This is the sum of the proportion column.</li>
</ul>
</li>
<li><strong>Eigenvalues of the Reduced Correlation Matrix</strong> table contains:<ul>
<li><strong>Eigenvalue</strong>: This is the eigenvalue obtained after the principal axis factoring but <strong>before the varimax rotation</strong>.    </li>
<li><strong>Difference</strong>, <strong>Proportion</strong> and <strong>Cumulative</strong> show the same information described for the <strong>Prior Communality Estimates:  SMC</strong> table</li>
</ul>
</li>
<li>The <strong>Eigenvectors</strong> table shows the linear combinations of the original variables. They tell you about the strength of the relationship between the original (manifest) variables and the (latent) factors.</li>
<li>The <strong>Factor Pattern</strong> table contains the unrotated factor loadings, which are the correlations between the variable and the factor.  Because these are correlations, possible <strong>values range from -1 to +1</strong>.</li>
<li>The <strong>Final Communality Estimates</strong> table shows the proportion of each variable’s variance that can be explained by the retained factors prior to the rotation. Variables with high values are well represented in the common factor space, while variables with low values are not well represented. They are the reproduced variances from the factors that you have extracted.  You can find these values on the diagonal of the reproduced correlation matrix.</li>
<li>The <strong>Orthogonal Transformation Matrix</strong> table shows the matrix by which you multiply the unrotated factor matrix to get the rotated factor matrix.</li>
<li>The <strong>Rotated Factor Pattern</strong> table contains the rotated factor loadings, which are the correlations between the variable and the factor.  Because these are correlations, possible <strong>values range from -1 to +1</strong>.<ul>
<li>The <strong>Factor</strong> columns in this table are the rotated factors that have been extracted. These are the factors that analysts are most interested in and try to name looking at the items that load highly on it. The second factor might be called "relating to students" because items like "instructor is sensitive to students" and "instructor allows me to ask questions" load highly on it.  The third factor has to do with comparisons to other instructors and courses.</li>
</ul>
</li>
<li><code>ROTATE = PROMAX</code> | <code>VARIMAX</code> invokes one of the rotation methods available. If no method is specified, the SAS default is to use no rotation. <ul>
<li>With an orthogonal rotation, such as the <code>VARIMAX</code>, the factors are not permitted to be correlated. Orthogonal transformations simplify the interpretation of the factors by maximizing the variances of the squared loadings for each factor, which are the columns of the factor pattern. Please note that with orthogonal rotations the factor pattern and the factor structure matrices are the equal.</li>
<li>With an oblique rotation, such as a <code>PROMAX</code> rotation, the factors are permitted to be correlated with one another and both factor pattern and factor structure matrices are produced. The factor pattern matrix gives the linear combination of the variables that make up the factors. The factor structure matrix presents the correlations between the variables and the factors. To completely interpret an oblique rotation one needs to take into account both the factor pattern and the factor structure matrices and the correlations among the factors. </li>
</ul>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Check these websites</p>
<ul>
<li><a href="https://stats.idre.ucla.edu/sas/output/factor-analysis/">Factor Analysis: SAS Annotated Output</a></li>
<li><a href="http://www2.sas.com/proceedings/sugi22/STATS/PAPER268.PDF"><code>PROC FACTOR</code>: How to Interpret the Output of a Real-World Example</a></li>
</ul>
</div>
<h3 id="standardize-your-data">Standardize your Data<a class="headerlink" href="#standardize-your-data" title="Permanent link">Link</a></h3>
<p>When performing multivariate analysis, having variables that are measured at different scales can influence the numerical stability and precision of the estimators. Standardizing the data prior to performing statistical analysis can often prevent this problem.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="k">DATA</span> <span class="n">SAS</span><span class="o">-</span><span class="k">data</span><span class="o">-</span><span class="k">set</span><span class="p">;</span>
    <span class="k">SET</span> <span class="n">SAS</span><span class="o">-</span><span class="k">data</span><span class="o">-</span><span class="k">set</span><span class="o">-</span><span class="n">unformatted</span><span class="p">;</span>
    <span class="n">format</span> <span class="n">variable1</span> <span class="n">variable2</span> <span class="n">variable3</span> <span class="mi">10</span><span class="p">.</span><span class="mi">4</span><span class="p">;</span>
<span class="n">RUN</span><span class="p">;</span>

<span class="n">PROC</span> <span class="n">STANDARD</span> <span class="k">DATA</span><span class="o">=</span><span class="n">SAS</span><span class="o">-</span><span class="k">data</span><span class="o">-</span><span class="k">set</span> <span class="k">out</span><span class="o">=</span><span class="n">SAS</span><span class="o">-</span><span class="k">output</span><span class="o">-</span><span class="k">data</span><span class="o">-</span><span class="k">set</span> <span class="n">MEAN</span><span class="o">=</span><span class="mi">0</span> <span class="n">STD</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="n">VAR</span> <span class="n">variable1</span> <span class="n">variable2</span> <span class="n">variable3</span><span class="p">;</span>
<span class="n">RUN</span><span class="p">;</span>
</code></pre></div>
</td></tr></table>

<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Do not forget to change the format of your numerical data and increase the number of decimal places before performing the standardization. Otherwise you may lose a lot of details on this process that can be crucial for the data analysis.</p>
</div>
<div class="admonition summary">
<p class="admonition-title">Check these websites</p>
<ul>
<li><a href="https://support.sas.com/rnd/app/stat/procedures/Standardization.html">Standardization Procedures</a></li>
<li><a href="https://support.sas.com/documentation/cdl/en/statug/63033/HTML/default/viewer.htm#statug_stdize_sect020.htm">Standardization of Variables in Cluster Analysis</a></li>
</ul>
</div>
<h2 id="sas-procedures-to-perform-cluster-analysis">SAS Procedures to Perform Cluster Analysis<a class="headerlink" href="#sas-procedures-to-perform-cluster-analysis" title="Permanent link">Link</a></h2>
<p>Ward's minimum-variance hierarchical clustering method using agglomerative (bottom-up) approach and Ward's linkage.</p>
<div class="admonition summary">
<p class="admonition-title">Check these websites</p>
<ul>
<li><a href="http://documentation.sas.com/?docsetId=statug&amp;docsetTarget=statug_introclus_toc.htm&amp;docsetVersion=14.2">Introduction to Clustering Procedures</a></li>
</ul>
</div>
<h3 id="proc-cluster-hierarchical-cluster-analysis"><code>PROC CLUSTER</code>: Hierarchical Cluster Analysis<a class="headerlink" href="#proc-cluster-hierarchical-cluster-analysis" title="Permanent link">Link</a></h3>
<p>The <code>CLUSTER</code> procedure <strong>hierarchically clusters the observations</strong> in a SAS data set by using one of 11 methods. The data can be coordinates or distances. </p>
<p>All methods are based on the usual agglomerative hierarchical clustering procedure. Each observation begins in a cluster by itself. The two closest clusters are merged to form a new cluster that replaces the two old clusters. Merging of the two closest clusters is repeated until only one cluster is left. The various clustering methods differ in how the distance between two clusters is computed.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="k">data</span> <span class="n">t</span><span class="p">;</span>
    <span class="k">input</span> <span class="n">cid</span> <span class="err">$</span> <span class="mi">1</span><span class="o">-</span><span class="mi">2</span> <span class="n">income</span> <span class="n">educ</span><span class="p">;</span>
<span class="n">cards</span><span class="p">;</span>
<span class="n">c1</span> <span class="mi">5</span> <span class="mi">5</span>
<span class="n">c2</span> <span class="mi">6</span> <span class="mi">6</span>
<span class="n">c3</span> <span class="mi">15</span> <span class="mi">14</span>
<span class="n">c4</span> <span class="mi">16</span> <span class="mi">15</span>
<span class="n">c5</span> <span class="mi">25</span> <span class="mi">20</span>
<span class="n">c6</span> <span class="mi">30</span> <span class="mi">19</span>
<span class="n">run</span><span class="p">;</span>

<span class="n">proc</span> <span class="k">cluster</span> <span class="k">simple</span> <span class="n">noeigen</span> <span class="k">method</span><span class="o">=</span><span class="n">centroid</span> <span class="n">rmsstd</span> <span class="n">rsquare</span> <span class="n">nonorm</span> <span class="k">out</span><span class="o">=</span><span class="n">tree</span><span class="p">;</span>
<span class="n">id</span> <span class="n">cid</span><span class="p">;</span>
<span class="n">var</span> <span class="n">income</span> <span class="n">educ</span><span class="p">;</span>
<span class="n">run</span><span class="p">;</span>
</code></pre></div>
</td></tr></table>

<ul>
<li>The <code>SIMPLE</code> option displays simple, descriptive statistics. </li>
<li>The <code>NOEIGEN</code> option suppresses computation of eigenvalues. Specifying the <code>NOEIGEN</code> option saves time if the number of variables is large, but it should be used only if the variables are nearly uncorrelated or if you are not interested in the cubic clustering criterion. </li>
<li>The <code>METHOD=</code> specification determines the clustering method used by the procedure. Here, we are using <code>CENTROID</code> method. The <code>Centroid Distance</code> that appears in the output is simply the Euclidian distance between the centroid of the two clusters that are to be joined or merged. It is a measure of the homogeneity of merged clusters and the value should be small.</li>
<li>The <code>RMSSTD</code> option displays the root-mean-square standard deviation of each cluster. <code>RMSSTD</code> is the pooled standard deviation of all the variables forming the cluster. Since the objective of cluster analysis is to form homogeneous groups, the <code>RMSSTD</code> of a cluster should be as small as possible.</li>
<li>The <code>RSQUARE</code> option displays the $R^2$ (<code>RSQ</code>) and semipartial $R^2$ (<code>SPRSQ</code>) to evaluate cluster solution. <code>RSQ</code> measures the extent to which groups or clusters are different from each other (so, when you have just one cluster <code>RSQ</code> value is, intuitively, zero). Thus, the <code>RSQ</code> value should be high.<code>SPRSQ</code> is a measure of the homogeneity of merged clusters, i.e. the loss of homogeneity due to combining two groups or clusters to form a new group or cluster.  Thus, its value should be small to imply that we are merging two homogeneous groups. </li>
<li>The <code>NONORM</code> option prevents the distances from being normalized to unit mean or unit root mean square with most methods. </li>
<li>The values of the <code>ID</code> variable identify observations in the displayed cluster history and in the <code>OUTTREE=</code> data set. If the <code>ID</code> statement is omitted, each observation is denoted by <code>OBn</code>, where n is the observation number.</li>
<li>The <code>VAR</code> statement lists numeric variables to be used in the cluster analysis. If you omit the <code>VAR</code> statement, all numeric variables not listed in other statements are used.</li>
</ul>
<h3 id="proc-fastclus-disjoint-cluster-analysis"><code>PROC FASTCLUS</code>: Disjoint Cluster Analysis<a class="headerlink" href="#proc-fastclus-disjoint-cluster-analysis" title="Permanent link">Link</a></h3>
<p>The <code>FASTCLUS</code> procedure performs a <strong>disjoint cluster analysis</strong> on the basis of distances computed from one or more quantitative variables. The observations are <strong>divided into clusters such that every observation belongs to one and only one cluster</strong>; the clusters <strong>do not form a tree structure</strong> as they do in the <code>CLUSTER</code> procedure. If you want separate analyses for different numbers of clusters, you can run <code>PROC FASTCLUS</code> once for each analysis. The <code>FASTCLUS</code> procedure requires time proportional to the number of observations and thus can be used with much larger data sets than <code>PROC CLUSTER</code>.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="k">data</span> <span class="n">t2</span><span class="p">;</span>
    <span class="k">input</span> <span class="n">cid</span> <span class="err">$</span> <span class="mi">1</span><span class="o">-</span><span class="mi">2</span> <span class="n">income</span> <span class="n">educ</span><span class="p">;</span>
<span class="n">cards</span><span class="p">;</span>
<span class="n">c1</span> <span class="mi">5</span> <span class="mi">5</span>
<span class="n">c2</span> <span class="mi">6</span> <span class="mi">6</span>
<span class="n">c3</span> <span class="mi">15</span> <span class="mi">14</span>
<span class="n">c4</span> <span class="mi">16</span> <span class="mi">15</span>
<span class="n">c5</span> <span class="mi">25</span> <span class="mi">20</span>
<span class="n">c6</span> <span class="mi">30</span> <span class="mi">19</span>
<span class="n">run</span><span class="p">;</span>

<span class="n">proc</span> <span class="n">fastclus</span> <span class="n">radius</span><span class="o">=</span><span class="mi">0</span> <span class="k">replace</span><span class="o">=</span><span class="k">full</span> <span class="n">maxclusters</span><span class="o">=</span><span class="mi">3</span> <span class="n">maxiter</span><span class="o">=</span><span class="mi">20</span> <span class="n">list</span> <span class="n">distance</span><span class="p">;</span>
<span class="n">id</span> <span class="n">cid</span><span class="p">;</span>
<span class="n">var</span> <span class="n">income</span> <span class="n">educ</span><span class="p">;</span>
<span class="n">run</span><span class="p">;</span>
</code></pre></div>
</td></tr></table>

<p>You must specify either the <code>MAXCLUSTERS=</code> or the <code>RADIUS=</code> argument in the <code>PROC FASTCLUS</code> statement.</p>
<ul>
<li>The <code>RADIUS=</code> option establishes the minimum distance criterion for selecting new seeds. No observation is considered as a new seed unless its minimum distance to previous seeds exceeds the value given by the <code>RADIUS=</code> option. The default value is 0. </li>
<li>The <code>MAXCLUSTERS=</code> option specifies the maximum number of clusters allowed. If you omit the <code>MAXCLUSTERS=</code> option, a value of 100 is assumed. </li>
<li>
<p>The <code>REPLACE=</code> option specifies how seed replacement is performed. </p>
<ul>
<li><code>FULL</code> requests default seed replacement. </li>
<li><code>PART</code> requests seed replacement only when the distance between the observation and the closest seed is greater than the minimum distance between seeds. </li>
<li><code>NONE</code> suppresses seed replacement. </li>
<li><code>RANDOM</code> selects a simple pseudo-random sample of complete observations as initial cluster seeds. </li>
</ul>
</li>
<li>
<p>The <code>MAXITER=</code> option specifies the maximum number of iterations for recomputing cluster seeds. When the value of the <code>MAXITER=</code> option is greater than 0, each observation is assigned to the nearest seed, and the seeds are recomputed as the means of the clusters. </p>
</li>
<li>The <code>LIST</code> option lists all observations, giving the value of the <code>ID</code> variable (if any), the number of the cluster to which the observation is assigned, and the distance between the observation and the final cluster seed. </li>
<li>The <code>DISTANCE</code> option computes distances between the cluster means. </li>
<li>The <code>ID</code> variable, which can be character or numeric, identifies observations on the output when you specify the <code>LIST</code> option.</li>
<li>The <code>VAR</code> statement lists the numeric variables to be used in the cluster analysis. If you omit the <code>VAR</code> statement, all numeric variables not listed in other statements are used.</li>
</ul>
<p>The cluster analysis may converge to a solution at the $n^{th}$ iteration because the change in cluster seeds at this iteration is less than the convergence criterion.  Note that a zero change in the centroid of the cluster seeds for the $n^{th}$ iteration implies that the reallocation did not result in any reassignment of observations.</p>
<p>The statistics used for the evaluation of the cluster solution are the same as in the hierarchical cluster analysis.</p>
<p>The cluster solution can also be <strong>evaluated with respect to each clustering variable</strong>. If the measurement scales are not the same, then for each variable one should obtain the <strong>ratio</strong> of the respective <strong>Within STD</strong> to the <strong>Total STD</strong>, and compare this ratio across the variables.</p>
<div class="admonition tip">
<p class="admonition-title">Interesting Examples</p>
<ul>
<li><a href="http://support.sas.com/resources/papers/proceedings13/447-2013.pdf">Multivariate Statistical Analysis in SAS: Segmentation and Classification of Behavioral Data</a></li>
</ul>
</div>
<h3 id="mixed-clustering">Mixed Clustering<a class="headerlink" href="#mixed-clustering" title="Permanent link">Link</a></h3>
<p>On large data sets a useful methodology consists first in summarizing the observations in a large enough number of clusters (100 may be a standard value) and then applying a hierarchical clustering technique for aggregating these groups (Example <a href="https://support.sas.com/documentation/cdl/en/statug/63033/HTML/default/viewer.htm#statug_cluster_sect027.htm">here</a>).</p>
<p>This procedure has the advantages of the hierarchical method for showing an optimal number of clusters and solves the difficulty of the too high initial number of observations by first clustering them, using a non hierarchical method, in a smaller number of clusters. This number is a parameter of the procedure; it must be high enough in order not to impose a prior partitionning of the data.</p>
<h3 id="proc-varclus-variable-clustering"><code>PROC VARCLUS</code>: Variable Clustering<a class="headerlink" href="#proc-varclus-variable-clustering" title="Permanent link">Link</a></h3>
<p>The <code>VARCLUS</code> procedure divides a set of numeric variables into disjoint or hierarchical clusters. <code>PROC VARCLUS</code> tries to maximize the variance that is explained by the cluster components, summed over all the clusters.</p>
<p>In an ordinary principal component analysis, all components are computed from the same variables, and the first principal component is orthogonal to the second principal component and to every other principal component. In <code>PROC VARCLUS</code>, each cluster component is computed from a set of variables that is different from all the other cluster components. The first principal component of one cluster might be correlated with the first principal component of another cluster. Hence, the <code>PROC VARCLUS</code> algorithm is a type of oblique component analysis.</p>
<p><code>PROC VARCLUS</code> can be used as a <strong>variable-reduction method</strong>. A large set of variables can often be replaced by the set of cluster components with little loss of information. A given number of cluster components does not generally explain as much variance as the same number of principal components on the full set of variables, but the cluster components are usually easier to interpret than the principal components, even if the latter are rotated.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">PROC</span> <span class="n">VARCLUS</span> <span class="k">DATA</span><span class="o">=</span><span class="n">SAS</span><span class="o">-</span><span class="k">data</span><span class="o">-</span><span class="k">set</span> <span class="n">MAXEIGEN</span><span class="o">=</span><span class="mi">0</span><span class="p">.</span><span class="mi">7</span> <span class="n">OUTTREE</span><span class="o">=</span><span class="n">fortree</span> <span class="n">short</span> <span class="n">noprint</span><span class="p">;</span>  
    <span class="n">VAR</span> <span class="n">variable1</span> <span class="n">variable2</span> <span class="n">variable3</span><span class="p">;</span>
<span class="n">RUN</span><span class="p">;</span>
</code></pre></div>
</td></tr></table>

<h3 id="proc-tree"><code>PROC TREE</code><a class="headerlink" href="#proc-tree" title="Permanent link">Link</a></h3>
<p>The <code>TREE</code> procedure produces a tree diagram from a <strong>data set created by the <code>CLUSTER</code> or <code>VARCLUS</code> procedure</strong> that contains the results of <strong>hierarchical clustering</strong> as a tree structure.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">PROC</span> <span class="n">TREE</span> <span class="k">DATA</span><span class="o">=</span><span class="n">tree</span> <span class="k">OUT</span><span class="o">=</span><span class="n">clus3</span> <span class="n">NCLUSTERS</span><span class="o">=</span><span class="mi">3</span><span class="p">;</span>
    <span class="n">ID</span> <span class="n">id</span><span class="o">-</span><span class="k">variable</span><span class="p">;</span>
    <span class="k">COPY</span> <span class="n">variable1</span> <span class="n">variable2</span> <span class="n">variable3</span><span class="p">;</span>
<span class="n">RUN</span><span class="p">;</span>
</code></pre></div>
</td></tr></table>

<p>The <code>TREE</code> procedure produces a tree diagram, also known as a dendrogram or phenogram, using a data set created by the <code>CLUSTER</code> procedure. The <code>CLUSTER</code> procedure creates output data sets that contain the results of <strong>hierarchical clustering as a tree structure</strong>. The <code>TREE</code> procedure uses the output data set to produce a diagram of the tree structure.</p>
<ul>
<li>The <code>NCLUSTERS=</code> option specifies the number of clusters desired in the <code>OUT=</code> data set.</li>
<li>The <code>ID</code> variable is used to identify the objects (leaves) in the tree on the output. The <code>ID</code> variable can be a character or numeric variable of any length. </li>
<li>The <code>COPY</code> statement specifies one or more character or numeric variables to be copied to the <code>OUT=</code> data set.</li>
</ul>
<h2 id="choosing-the-optimal-number-of-clusters-for-the-analysis">Choosing the Optimal Number of Clusters for the Analysis<a class="headerlink" href="#choosing-the-optimal-number-of-clusters-for-the-analysis" title="Permanent link">Link</a></h2>
<p>In most cases, before using a clustering technique you have no prior idea of the number of clusters which will give the better differenciation of the data. The main objective is to summarize the data in the best way possible, i.e. getting a compromise between a good degree of differentiation and a not too high number of clusters.</p>
<p>For hierarchical clustering try the Sarle's Cubic Clustering Criterion in PROC CLUSTER:
plot <em>CCC</em> versus the number of clusters and look for peaks where <em>ccc</em> &gt; 3 or look for local peaks of pseudo-F statistic (<em>PSF</em>) combined with a small value of the pseudo-t^2 statistic (<em>PST2</em>) and a larger pseudo t^2 for the next cluster fusion.
For K-Means clustering use this approach on a sample of your data to determine the max limit for k and assign it to the maxc= option in PROC FASTCLUS on the complete data. </p>
<p>For K-means cluster analysis, one can use <code>PROC FASTCLUS</code> like
<code>PROC FASTCLUS DATA=SAS-data-set OUT=out MAXC=4 MAXITER=20;</code>
and change the number defined by <code>MAXC=</code>, and run a number of times, then compare the <strong>Pseduo F</strong> and <strong>CCC</strong> values, to see which number of clusters gives peaks.</p>
<p>You can also use <code>PROC CLUSTER</code>
<code>PROC CLUSTER data=mydata METHOD=WARD out=out ccc pseudo print=15;</code>
to find the number of clusters with <strong>pseudo F</strong>, <strong>pseudo-$t^2$</strong> and <strong>CCC</strong>, and also look at junp in <strong>Semipartial R-Square</strong>.</p>
<p>Sometimes these indications do not agree to each other. which indicator is more reliable?
If you are doubting between 2 k-values, you can use Beale's F-type statistic to determine the final number of clusters. It will tell you whether the larger solution is significantly better or not (in the latter case the solution with fewer clusters is preferable).
This technique is discussed in the "Applied Clustering Techniques" course notes.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="o">*</span> <span class="n">Define</span> <span class="n">the</span> <span class="n">variables</span> <span class="k">for</span> <span class="n">clustering</span><span class="p">;</span>
<span class="o">*------------------------------------</span><span class="p">;</span>
<span class="nf">%let</span> <span class="n">varlist</span><span class="o">=</span><span class="n">var1</span> <span class="n">var2</span> <span class="n">var3</span> <span class="n">var4</span> <span class="n">var5</span><span class="p">;</span>

<span class="o">*</span> <span class="n">Macro</span> <span class="n">with</span> <span class="n">the</span> <span class="n">cluster</span> <span class="n">procedure</span><span class="p">,</span> <span class="n">to</span> <span class="n">call</span> <span class="n">it</span> <span class="n">with</span> <span class="n">different</span> <span class="n">number</span> <span class="n">of</span> <span class="n">clusters</span><span class="p">;</span>
<span class="o">*-------------------------------------------------------------------------------</span><span class="p">;</span>
<span class="o">%</span><span class="n">MACRO</span> <span class="n">CLUSTERSIZE</span><span class="p">(</span>
         <span class="n">datain</span><span class="o">=</span>
        <span class="p">,</span><span class="n">dataout</span><span class="o">=</span>
        <span class="p">,</span><span class="n">maxclusters</span><span class="o">=</span>
        <span class="p">,</span><span class="n">maxiter</span><span class="o">=</span>
        <span class="p">);</span>
    <span class="n">proc</span> <span class="n">fastclus</span> <span class="n">data</span><span class="o">=&amp;</span><span class="n">datain</span><span class="p">.</span> <span class="n">out</span><span class="o">=&amp;</span><span class="n">dataout</span><span class="p">.</span><span class="o">&amp;</span><span class="n">maxclusters</span><span class="p">.</span> <span class="n">outstat</span><span class="o">=</span><span class="n">statdata</span><span class="o">&amp;</span><span class="n">maxclusters</span><span class="p">.</span> <span class="n">maxclusters</span><span class="o">=&amp;</span><span class="n">maxclusters</span><span class="p">.</span> <span class="n">maxiter</span><span class="o">=&amp;</span><span class="n">maxiter</span><span class="p">.</span> <span class="n">noprint</span><span class="p">;</span>
        <span class="n">id</span> <span class="n">patient</span><span class="p">;</span>
        <span class="n">var</span> <span class="o">&amp;</span><span class="n">varlist</span><span class="p">.;</span>
    <span class="n">run</span><span class="p">;</span>
    <span class="n">title</span><span class="p">;</span>
<span class="o">%</span><span class="n">MEND</span><span class="p">;</span>

<span class="o">*</span> <span class="n">Calcultion</span> <span class="n">of</span> <span class="n">the</span> <span class="n">cluster</span> <span class="n">analysis</span> <span class="n">statistics</span> <span class="k">for</span> <span class="mi">1</span><span class="o">-</span><span class="mi">20</span> <span class="n">clusters</span> <span class="n">and</span> <span class="n">data</span> <span class="n">set</span> <span class="n">creation</span> <span class="k">for</span> <span class="n">elbow</span> <span class="n">plot</span> <span class="n">with</span> <span class="n">RSQ</span> <span class="n">values</span><span class="p">;</span>
<span class="o">*---------------------------------------------------------------------------------------------------------------------</span><span class="p">;</span>
<span class="nf">%macro</span> <span class="n">statCLUSTER</span><span class="p">;</span>
     <span class="nf">%do</span> <span class="n">k</span><span class="o">=</span> <span class="mi">1</span> <span class="nf">%to</span> <span class="mi">20</span><span class="p">;</span>
        <span class="o">%</span><span class="n">CLUSTERSIZE</span><span class="p">(</span><span class="n">datain</span><span class="o">=</span><span class="n">SAS</span><span class="o">-</span><span class="n">data</span><span class="o">-</span><span class="n">set</span><span class="p">,</span> <span class="n">dataout</span><span class="o">=</span><span class="n">clusterdata</span><span class="p">,</span> <span class="n">maxclusters</span><span class="o">=&amp;</span><span class="n">k</span><span class="p">.,</span> <span class="n">maxiter</span><span class="o">=</span><span class="mi">1000</span><span class="p">);</span>
        <span class="n">data</span> <span class="n">clusrsq</span><span class="o">&amp;</span><span class="n">k</span><span class="p">.;</span>
            <span class="n">set</span> <span class="n">statdata</span><span class="o">&amp;</span><span class="n">k</span><span class="p">.;</span>
            <span class="n">nclust</span><span class="o">=&amp;</span><span class="n">k</span><span class="p">.;</span>
            <span class="k">if</span> <span class="n">_type_</span><span class="o">=</span><span class="err">&#39;</span><span class="n">RSQ</span><span class="err">&#39;</span><span class="p">;</span>
            <span class="n">keep</span> <span class="n">nclust</span> <span class="n">over_all</span><span class="p">;</span>
        <span class="n">run</span><span class="p">;</span>
     <span class="nf">%end</span><span class="p">;</span>
<span class="nf">%mend</span><span class="p">;</span>
<span class="nf">%stat</span><span class="n">CLUSTER</span><span class="p">;</span>

<span class="n">data</span> <span class="n">clus_rsq</span><span class="p">;</span>
    <span class="n">set</span> <span class="n">clusrsq1</span> <span class="n">clusrsq2</span> <span class="n">clusrsq3</span> <span class="n">clusrsq4</span> <span class="n">clusrsq5</span> <span class="n">clusrsq6</span> <span class="n">clusrsq7</span> <span class="n">clusrsq8</span> <span class="n">clusrsq9</span> <span class="n">clusrsq10</span> <span class="n">clusrsq11</span> <span class="n">clusrsq12</span> <span class="n">clusrsq13</span> <span class="n">clusrsq14</span> <span class="n">clusrsq15</span> <span class="n">clusrsq16</span> <span class="n">clusrsq17</span> <span class="n">clusrsq18</span> <span class="n">clusrsq19</span> <span class="n">clusrsq20</span><span class="p">;</span>
<span class="n">run</span><span class="p">;</span>

<span class="o">*</span> <span class="n">Remove</span> <span class="n">useless</span> <span class="n">data</span> <span class="n">sets</span><span class="p">;</span>
<span class="o">*-------------------------</span><span class="p">;</span>
<span class="n">proc</span> <span class="n">datasets</span> <span class="n">lib</span><span class="o">=</span><span class="n">work</span> <span class="n">nowarn</span> <span class="n">nolist</span> <span class="n">nodetails</span><span class="p">;</span> 
    <span class="k">delete</span> <span class="nl">clusrsq</span><span class="p">:</span> <span class="nl">statdata</span><span class="p">:</span> <span class="nl">clusterdata</span><span class="p">:</span> <span class="p">;</span>
<span class="n">run</span><span class="p">;</span> 
<span class="n">quit</span><span class="p">;</span>

<span class="o">*</span> <span class="n">Plot</span> <span class="n">elbow</span> <span class="n">curve</span> <span class="k">using</span> <span class="n">r</span><span class="o">-</span><span class="n">square</span> <span class="n">values</span> <span class="n">highlighting</span> <span class="n">the</span> <span class="n">best</span> <span class="n">candidates</span> <span class="n">to</span> <span class="n">optimum</span> <span class="n">number</span> <span class="n">of</span> <span class="n">clusters</span><span class="p">;</span>
<span class="o">*------------------------------------------------------------------------------------------------------</span><span class="p">;</span>
<span class="n">symbol1</span> <span class="n">color</span><span class="o">=</span><span class="n">blue</span> <span class="n">interpol</span><span class="o">=</span><span class="n">join</span><span class="p">;</span>
<span class="n">axis1</span> <span class="n">label</span><span class="o">=</span><span class="p">(</span><span class="err">&#39;</span><span class="n">Number</span> <span class="n">of</span> <span class="n">clusters</span> <span class="n">in</span> <span class="n">the</span> <span class="n">analysis</span><span class="err">&#39;</span><span class="p">)</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span> <span class="n">to</span> <span class="mi">15</span> <span class="n">by</span> <span class="mi">1</span><span class="p">)</span> <span class="n">reflabel</span><span class="o">=</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">c</span> <span class="n">h</span><span class="o">=</span><span class="mi">9</span><span class="n">pt</span> <span class="err">&#39;</span><span class="n">Candidate</span> <span class="mi">1</span><span class="sc">&#39; &#39;</span><span class="n">Candidate</span> <span class="mi">2</span><span class="err">&#39;</span><span class="p">);</span>
<span class="n">axis2</span> <span class="n">label</span><span class="o">=</span><span class="p">(</span><span class="err">&#39;</span><span class="n">R</span><span class="o">^</span><span class="mi">2</span> <span class="n">values</span><span class="err">&#39;</span> <span class="n">j</span><span class="o">=</span><span class="n">c</span><span class="p">);</span>
<span class="n">proc</span> <span class="n">gplot</span> <span class="n">data</span><span class="o">=</span><span class="n">clus_rsq</span><span class="p">;</span>
    <span class="n">plot</span> <span class="n">over_all</span><span class="o">*</span><span class="n">nclust</span> <span class="o">/</span> <span class="n">haxis</span><span class="o">=</span><span class="n">axis1</span> <span class="n">vaxis</span><span class="o">=</span><span class="n">axis2</span> <span class="n">href</span><span class="o">=</span><span class="mi">3</span> <span class="mi">5</span><span class="p">;</span>
<span class="n">run</span><span class="p">;</span>
</code></pre></div>
</td></tr></table>

<div class="admonition summary">
<p class="admonition-title">Check these websites</p>
<ul>
<li><a href="http://support.sas.com/documentation/cdl/en/statug/63033/HTML/default/viewer.htm#statug_introclus_sect010.htm">The Number of Clusters</a></li>
</ul>
</div>
<h2 id="further-examination-of-the-cluster-analysis-solution">Further Examination of the Cluster Analysis Solution<a class="headerlink" href="#further-examination-of-the-cluster-analysis-solution" title="Permanent link">Link</a></h2>
<h3 id="visualizing-the-results">Visualizing the Results<a class="headerlink" href="#visualizing-the-results" title="Permanent link">Link</a></h3>
<p>To interpret a cluster analysis solution, the first thing you want to try is to graph the cluster in a scatter plot to see whether or not they overlap with each other in terms of their location in the $p-$dimensional space. If the vectors have a high dimensionality,  we use <strong>Canonical Discriminant Analysis (CDA)</strong>. It is a <strong>dimension-reduction technique related to principal component analysis and canonical correlation</strong>. It creates a smaller number of variables that are linear combinations of the original $p$ clustering variables. The new variables, called canonical variables, are ordered in terms of the proportion of variance in the clustering variables that is accounted for by each of the canonical variables. Usually, the majority of the variants in the clustering variable will be accounted for by the first couple of canonical varaibles and those are the variables we can plot.</p>
<p>In SAS we can use the <code>CANDISC</code>procedure to create the canonical variables for our cluster analysis output data set that has the cluster assignment variable that we created when we ran the cluster analysis. </p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">PROC</span> <span class="n">CANDISC</span> <span class="k">DATA</span><span class="o">=</span><span class="n">clusterdata</span> <span class="k">OUT</span><span class="o">=</span><span class="n">candata</span><span class="p">;</span>
    <span class="k">CLASS</span> <span class="k">cluster</span><span class="o">-</span><span class="k">assignment</span><span class="o">-</span><span class="k">variable</span><span class="p">;</span>
    <span class="n">VAR</span> <span class="n">clustering1</span> <span class="n">clustering2</span><span class="p">;</span>
<span class="n">RUN</span><span class="p">;</span>
</code></pre></div>
</td></tr></table>

<ul>
<li>The <code>OUT=</code> is the output data set that includes the canonical variables that are estimated by the canonical discriminate analysis.</li>
<li>The <code>CLASS</code> variable (mandatory) is the cluster assignment variable which is a categorical variable.</li>
<li>In the <code>VAR</code> statement we list the clustering variables</li>
</ul>
<p>You can then plot the first two canonical variables using the <code>SGPLOT</code> procedure:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">PROC</span> <span class="n">SGPLOT</span> <span class="k">DATA</span><span class="o">=</span><span class="n">candata</span><span class="p">;</span>
    <span class="n">SCATTER</span> <span class="n">Y</span><span class="o">=</span><span class="n">can2</span> <span class="n">X</span><span class="o">=</span><span class="n">can1</span> <span class="o">/</span> <span class="k">GROUP</span><span class="o">=</span><span class="k">cluster</span><span class="o">-</span><span class="k">assignment</span><span class="o">-</span><span class="k">variable</span><span class="p">;</span>
<span class="n">RUN</span><span class="p">;</span>
</code></pre></div>
</td></tr></table>

<p>Let's analyze the following example result for a 4-cluster analysis.</p>
<p><img alt="Scatter plot of canonical variables by cluster" src="../../images/candisc4clustering.PNG" title="Scatter plot of canonical variables by cluster" /></p>
<p>What this shows is that the observations in <strong>clusters 1 and 4</strong> are densely packed, meaning they are pretty highly correlated with each other, and <strong>within cluster variance is relatively low</strong>. In addition, they <strong>do not overlap</strong> very much with the other clusters. The observations from <strong>cluster 2</strong> are a little more spread out, indicating less correlation among the observations and higher within cluster variance. But generally, the cluster is relatively distinct with the exception of some observations which are closer to clusters 1 and 4 indicating <strong>some overlap</strong> with these clusters. However, <strong>cluster 3</strong> is all over the place. There is come indication of a cluster but the observations are spread out more than the other clusters. This means that the <strong>within cluster variance is high</strong> as there is less correlation between the observations in this cluster, so we do not really know what is going to happen with that cluster. What this suggests is that the <strong>best cluster solution may have fewer than 4 clusters</strong>, meaning that it would be especially important to further evaluate the cluster solutions with fewer than four clusters.</p>
<div class="admonition summary">
<p class="admonition-title">Check these websites</p>
<ul>
<li><a href="https://stats.idre.ucla.edu/sas/dae/discriminant-function-analysis/">Discriminant Function Analysis in SAS (UCLA)</a></li>
<li><a href="http://documentation.sas.com/?docsetId=statug&amp;docsetTarget=statug_introdisc_toc.htm&amp;docsetVersion=14.2">Introduction to Discriminant Procedures</a></li>
</ul>
</div>
<h3 id="cluster-means-and-standard-deviations">Cluster Means and Standard Deviations<a class="headerlink" href="#cluster-means-and-standard-deviations" title="Permanent link">Link</a></h3>
<p>You can also check these values per cluster to detect possible similarities between groups and detect the most different ones.</p>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../HR_vs_OR_vs_RR/" title="Odds Ratio, Hazard Ratio and Relative Risk" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Odds Ratio, Hazard Ratio and Relative Risk
              </span>
            </div>
          </a>
        
        
          <a href="../../procedures/regression-models/" title="General Notes on Regression Procedures" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                General Notes on Regression Procedures
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org" target="_blank" rel="noopener">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.c33a9706.js"></script>
      
      <script>app.initialize({version:"1.1",url:{base:"../.."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
        <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
      
        <script src="../../js/mathjaxhelper.js"></script>
      
    
  </body>
</html>